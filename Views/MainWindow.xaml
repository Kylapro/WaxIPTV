<Window x:Class="WaxIPTV.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:views="clr-namespace:WaxIPTV.Views"
        Title="WaxIPTV"
        Height="600"
        Width="980"
        MinHeight="400"
        MinWidth="600"
        Background="{DynamicResource BgBrush}"
        Foreground="{DynamicResource TextBrush}"
        Icon="pack://application:,,,/WaxIPTVIcon.ico">
    <!--
        The main application window displays a list of IPTV channels
        alongside a Now/Next panel and playback controls.  A top
        level menu provides access to the settings dialog and an
        exit command.  Channels can be double‑clicked to start
        playback immediately; the play/pause/stop buttons control
        the currently active external player.
    -->
    <DockPanel>
        <!-- Top bar with search and shortcut icons -->
        <DockPanel DockPanel.Dock="Top" Margin="0,0,0,4">
            <!-- Shortcut buttons on the left -->
            <StackPanel DockPanel.Dock="Left" Orientation="Horizontal" Margin="0,0,8,0">
                <!-- EPG guide button -->
                <Button Width="32" Height="32" ToolTip="EPG Guide"
                        Click="EpgGuide_Click" Style="{DynamicResource AccentButton}">
                    <TextBlock FontFamily="Segoe MDL2 Assets" FontSize="16" Text="&#xE12B;"/>
                </Button>
                <!-- Settings button -->
                <Button Width="32" Height="32" ToolTip="Settings"
                        Click="SettingsMenu_Click" Style="{DynamicResource AccentButton}">
                    <TextBlock FontFamily="Segoe MDL2 Assets" FontSize="16" Text="&#xE713;"/>
                </Button>
            </StackPanel>
            <Button Content="Clear"
                    DockPanel.Dock="Right"
                    Margin="8,0,8,0"
                    Click="ClearSearch_Click"
                    Style="{DynamicResource AccentButton}"/>
            <TextBox x:Name="SearchBox"
                     Margin="8,0"
                     VerticalAlignment="Center"
                     TextChanged="SearchBox_TextChanged"
                     Background="{DynamicResource SurfaceBrush}"
                     Foreground="{DynamicResource TextBrush}"
                     BorderBrush="{DynamicResource DividerBrush}"
                     BorderThickness="1"
                     MinWidth="300"/>
        </DockPanel>

        <!-- EPG loading indicator.  This panel shows a brief message and
             an indeterminate progress bar while the EPG data is being
             downloaded or parsed.  It is hidden by default and toggled
             in the code-behind during EPG loads. -->
        <StackPanel x:Name="MainEpgLoadingPanel"
                    DockPanel.Dock="Top"
                    Orientation="Horizontal"
                    Visibility="Collapsed"
                    Margin="8,0">
            <TextBlock x:Name="MainEpgLoadingLabel"
                       Text="Loading EPG..."
                       VerticalAlignment="Center"
                       Margin="0,0,8,0"/>
            <ProgressBar x:Name="MainEpgProgressBar"
                         Width="200"
                         Height="4"
                         VerticalAlignment="Center"
                         IsIndeterminate="True"/>
        </StackPanel>

        <!-- Main content: two columns -->
        <Grid Margin="8">
            <Grid.ColumnDefinitions>
                <!-- Fixed width for the channel list -->
                <ColumnDefinition Width="280"/>
                <!-- Remaining space for the now/next panel -->
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Left: filter bar and channel list -->
            <Grid Grid.Column="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <!-- Filter bar: provides a group selector and EPG counters. -->
                <DockPanel Margin="0,0,0,8" Grid.Row="0">
                    <!-- Group filter on the left -->
                    <StackPanel Orientation="Horizontal" DockPanel.Dock="Left" Margin="0,0,8,0">
                        <TextBlock Text="Group" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <ComboBox x:Name="GroupFilter" Width="160"
                                  SelectionChanged="GroupFilter_SelectionChanged"
                                  Background="{DynamicResource DropdownBrush}"
                                  Foreground="{DynamicResource TextBrush}"
                                  BorderBrush="{DynamicResource DividerBrush}"
                                  BorderThickness="1"/>
                    </StackPanel>
                    <!-- EPG counters: displays how many channels and programmes were loaded and mapped.
                         Placed on the right side of the filter bar.  Hidden until EPG is loaded. -->
                    <TextBlock x:Name="EpgCountersText"
                               DockPanel.Dock="Right"
                               Margin="8,0,0,0"
                               VerticalAlignment="Center"
                               Foreground="{DynamicResource TextBrush}"
                               Text="EPG: (waiting…)"
                               ToolTip="Shows counts after EPG loads"/>
                </DockPanel>
                <!-- Channel list -->
                <views:ChannelListView x:Name="ChannelList" Grid.Row="1"
                                       ChannelActivated="ChannelList_ChannelActivated"/>
            </Grid>

            <!-- Right: selected channel title, now/next and controls.  The
                 entire panel is placed inside a card using the SurfaceBrush
                 and ThemeCornerRadius tokens.  Padding and spacing are
                 defined via design tokens to ensure consistent layout. -->
            <Border Grid.Column="1"
                    Margin="12,0,0,0"
                    Background="{DynamicResource SurfaceBrush}"
                    CornerRadius="{DynamicResource ThemeCornerRadius}"
                    Padding="{DynamicResource SpacingM}">
                <StackPanel>
                    <!-- Selected channel name -->
                    <TextBlock x:Name="SelectedChannelTitle" FontSize="18" FontWeight="Bold" Margin="0,0,0,8"/>
                    <!-- Now/next view -->
                    <views:EpgNowNext x:Name="NowNext"/>
                    <!-- Playback controls -->
                    <StackPanel Orientation="Horizontal" Margin="0,12,0,0">
                        <Button x:Name="PlayButton" Content="Play" Width="80" Margin="0,0,8,0" Click="PlayButton_Click" Style="{DynamicResource AccentButton}"/>
                        <Button x:Name="PauseButton" Content="Pause" Width="80" Margin="0,0,8,0" Click="PauseButton_Click" Style="{DynamicResource AccentButton}"/>
                        <Button x:Name="StopButton" Content="Stop" Width="80" Click="StopButton_Click" Style="{DynamicResource AccentButton}"/>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Grid>
    </DockPanel>
</Window>
